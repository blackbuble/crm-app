{
    "providers": [
        "php",
        "node"
    ],
    "phases": {
        "setup": {
            "nixPkgs": [
                "php83",
                "php83Extensions.mbstring",
                "php83Extensions.pdo",
                "php83Extensions.pdo_mysql",
                "php83Extensions.gd",
                "php83Extensions.zip",
                "php83Extensions.bcmath",
                "php83Extensions.intl",
                "php83Extensions.redis",
                "nodejs_20",
                "npm"
            ],
            "aptPkgs": []
        },
        "install": {
            "cmds": [
                "composer install --no-dev --optimize-autoloader --no-interaction --prefer-dist",
                "npm ci --include=dev"
            ]
        },
        "build": {
            "cmds": [
                "npm run build",
                "php artisan config:cache",
                "php artisan route:cache",
                "php artisan view:cache",
                "php artisan filament:optimize"
            ]
        }
    },
    "start": {
        "cmd": "php artisan serve --host=0.0.0.0 --port=${PORT:-8080}"
    }
}